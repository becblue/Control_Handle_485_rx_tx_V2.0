# STM32通信控制项目

## 项目概述
这是一个基于STM32单片机的通信控制项目，支持数据采集和控制功能。项目包含两种工作模式：发送模式(SEND)和接收模式。

### 主要功能
- 数据采集和发送
- IO控制
- 模拟量输出
- UART通信
- 定时器功能

## 硬件要求
- MCU: STM32系列单片机
- 通信接口: UART1 (115200波特率)
- 定时器: TIM2
- IO接口
- AD采样接口
- 模拟输出接口

## 软件架构

### 核心模块
1. **通信模块 (STM32_Uart1)**
   - 负责UART1通信
   - 支持115200波特率
   - 包含数据发送和接收功能

2. **定时器模块 (timer2)**
   - 基于TIM2
   - 提供定时功能
   - 定时精度1ms

3. **IO控制模块 (IO/IOApp)**
   - 管理IO输入输出
   - 支持IO状态读取和设置

4. **AD采样模块 (ADApp)**
   - 用于模拟量采集
   - 仅在发送模式下启用

5. **模拟输出模块 (AOApp)**
   - 处理模拟量输出
   - 仅在接收模式下启用

6. **数据处理模块**
   - 包含平均值计算(Average)
   - CRC校验功能(crc)

### 通信协议
数据帧格式：
- 帧头: 0xAA
- 数据长度: 14字节
- CRC校验: Modbus CRC-16

## 工作模式

### 发送模式 (DEVICE_MODE_SEND)
1. 定时采集数据
2. 打包IO状态和AD采样值
3. 添加CRC校验
4. 通过UART发送数据包

### 接收模式
1. 接收数据并进行CRC校验
2. 更新IO输出状态
3. 设置模拟输出值
4. 返回确认信息

## 目录结构 